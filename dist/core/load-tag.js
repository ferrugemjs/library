define(["require","exports","incremental-dom","./register-tag"],function(e,t,r,o){"use strict";var n=function(){function e(){}return e.prototype.refresh=function(){if(this._$el$domref)if(document.getElementById(this._$el$domref))r.patch(document.getElementById(this._$el$domref),function(){this._$render_from_powerup(this,o["default"],a)}.bind(this));else if(this.detached){this.detached();var e=this;setTimeout(function(){e=null})}},e}(),i=function(){function e(){}return e.prototype.initModule=function(e){if(document.getElementById(e.target)){var t=o["default"].getRegistred(e.tag),r=new t._$controller;r._$el$domref=e.target,r.refresh(),r.attached&&r.attached(),this.changeProps(r,e.host_vars)}},e.prototype.load=function(e,t,i){for(var a=[],s=3;s<arguments.length;s++)a[s-3]=arguments[s];console.log(t);var f=o["default"].getRegistred(e),u="custom_element_id_"+(new Date).getTime();t&&"nokey"!==t||(u=t),r.elementOpen("div",u,["id",u,"class",f.tag]),r.elementClose("div"),a&&(i||(i=[]),a.forEach(function(e){i.push(e)}));var c={tag:f.tag,target:u,host_vars:i};if(f&&f._$controller)this.initModule(c);else{var l=this;o["default"].setLoading(f.tag),System["import"](f.url).then(function(e){var t=Object.keys(e)[0];o["default"].config(f.tag,e[t]),System["import"](f.url+".html").then(function(r){var o=Object.keys(r)[0];e[t].prototype.refresh||(e[t].prototype.content=function(){},e[t].prototype._$render_from_powerup=r[o],e[t].prototype.refresh=n.prototype.refresh),l.initModule(c)})})}return this},e.prototype.content=function(e){},e.prototype.changeProps=function(e,t){if(t&&t.length>1)for(var r=t.length,o=0;o<r;o+=2){var n=t[o],i=t[o+1],a="set"+n.replace(/(^\D)/g,function(e,t){return e.toUpperCase()});e[a]?e[a](i):e[n]=i}},e}(),a=new i;Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=a});