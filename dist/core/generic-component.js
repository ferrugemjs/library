define(["require","exports","incremental-dom"],function(t,e,a){"use strict";var r={},s=(new Date).getTime()+1298;a.notifications.nodesDeleted=function(t){t.forEach(function(t){t.id&&r[t.id]&&r[t.id].detached&&r[t.id].detached(),t.id&&r[t.id]&&(r[t.id]=null,delete r[t.id])})};var n=function(){function t(){}return t.prototype.build=function(e){var a="";if(e.hostVars&&e.hostVars["key:id"]?(a=e.hostVars["key:id"],delete e.hostVars["key:id"]):e.staticVars&&e.staticVars["key:id"]&&(a=e.staticVars["key:id"],delete e.staticVars["key:id"]),e.classFactory.prototype.refresh||(e.classFactory.prototype.refresh=t.prototype.refresh),e.classFactory.prototype.content||(e.classFactory.prototype.content=t.prototype.content),a&&r[a])return r[a];if(a&&!r[a])return r[a]=new e.classFactory,r[a]._$target$_=e.target,r[a]._$key$_=a,r[a]._$tagName$_=e.tagName,this.changeAttrs.call(r[a],e.hostVars),this.changeAttrs.call(r[a],e.staticVars),r[a];var s=new e.classFactory;return s._$target$_=e.target,s._$tagName$_=e.tagName,this.changeAttrs.call(s,e.hostVars),this.changeAttrs.call(s,e.staticVars),s},t.prototype.content=function(t){return t?this._$content$_=t:this._$content$_&&this._$content$_(),this},t.prototype.changeAttrs=function(t,e){if(t)for(var a in t){var r=e&&("is"===a||"id"===a);if(!r){var s=a.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),n=t[a];if(s.indexOf(".")>-1){var o=s.split(".");this[o[0]][o[1]](n)}else{var i="set"+s.replace(/(^\D)/g,function(t,e){return t.toUpperCase()});this[i]?this[i](n):this[s]=n}}}},t.prototype.refresh=function(){var t=this;if(t._$target$_&&document.getElementById(t._$target$_))a.patch(document.getElementById(t._$target$_),t.render.bind(t),t),!t._$loaded$_&&t.attached&&(t._$loaded$_=!0,t.attached(),document.getElementById(t._$target$_).className=t._$style_name$_||t._$tag_name$_);else{t._$target$_=t._$target$_?t._$target$_:"uid_"+s++;var e=t._$style_name$_||t._$tag_name$_;a.elementOpen(t._$tag_name$_,t._$key$_?t._$key$_:null,["is",t._$tag_name$_,"id",t._$target$_,"class",e]),t.render.call(t,t),a.elementClose(t._$tag_name$_),!t._$loaded$_&&t.attached&&(t._$loaded$_=!0,t.attached())}},t.prototype.compose=function(t,e,a,r,s){var n=this;System["import"](t+".html").then(function(t){n.build({classFactory:t["default"],hostVars:a,staticVars:r,target:e,tagName:"compose-view"}).content(s).refresh()})},t}();e.FerrugemJSFactory=n,Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=new n});